{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dinker/Projects/React/simpleApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dinker/Projects/React/simpleApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/dinker/Projects/React/simpleApp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useReducer,useState}from'react';import axios from'axios';import'../../assets/css/App.css';import todoReducer from'../../reducer/todo.reducer';import{URL,FILTER}from'../../app.constant';import filterReducer from'../../reducer/filter.reducer';import filterTodos from'./todo.filter';var Todos=function Todos(){var initialState={isLoading:true,isError:false,todos:[],newTodoLabel:'Learn smthing new?'};var _useReducer=useReducer(todoReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var _useReducer3=useReducer(filterReducer,'ALL'),_useReducer4=_slicedToArray(_useReducer3,2),filter=_useReducer4[0],dispatchFilter=_useReducer4[1];var todos=state.todos,newTodoLabel=state.newTodoLabel,isLoading=state.isLoading,isError=state.isError;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),focus=_useState2[0],setFocus=_useState2[1];useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:'FETCH_INIT'});_context.next=3;return axios.get(URL.TODOS).then(function(res){return res.data;}).then(function(result){return dispatch({type:'FETCH_SUCCESS',payload:result});}).catch(function(error){dispatch({type:'FETCH_FAILURE'});Error(\"Something went wrong... See \".concat(error));});case 3:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[]);// second empty array parameter to encure that useEffect is running once\nvar filteredTodos=filterTodos(todos,filter);var handleShowAll=function handleShowAll(){return dispatchFilter({type:FILTER.SHOW_ALL});};var handleShowCompleted=function handleShowCompleted(){return dispatchFilter({type:FILTER.SHOW_COMPLETED});};var handleShowIncompleted=function handleShowIncompleted(){return dispatchFilter({type:FILTER.SHOW_INCOMPLETED});};// we could've used 1 function to make this work\n// const handleFilterDisplay = (filter) => dispatchFilter({type: filter})\nvar handleTodoSubmit=function handleTodoSubmit(event){// manque la gestion derreur\nevent.preventDefault();axios.post(URL.TODOS,{name:newTodoLabel,completed:false,editing:false}).then(function(res){dispatch({type:'ADD_TODO',payload:res.data.name});});};var handleTodoDelete=function handleTodoDelete(todo){// manque la gestion derreur\n// const newTodo = filteredTodos.some((el) => el.id === todo.id);\naxios.delete(\"\".concat(URL.TODOS,\"/\").concat(todo.id)).then(function(){return dispatch({type:'REMOVE_TODO',payload:todo.id});});};return/*#__PURE__*/React.createElement(\"div\",{className:\"App-todos\"},isError?/*#__PURE__*/React.createElement(\"h1\",null,\"Something went wrong...\"):isLoading&&/*#__PURE__*/React.createElement(\"h1\",null,\"Loading ...\")||/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"App-todo-heading\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"mt-4\"},\"You have \",filteredTodos.length,\" to do today\")),/*#__PURE__*/React.createElement(\"div\",{className:\"App-new-todo\"},/*#__PURE__*/React.createElement(\"form\",{className:\"form-inline\",onSubmit:handleTodoSubmit},/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",type:\"text\",name:\"todo\",value:newTodoLabel,onChange:function onChange(_ref2){var target=_ref2.target;return dispatch({type:'UPDATE_TODO_LABEL',payload:target.value});}}),/*#__PURE__*/React.createElement(\"button\",{className:\"ml-2 btn btn-primary\",type:\"submit\",onClick:function onClick(e){return handleTodoSubmit(e);}},\"Add\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"App-todo-item\"},filteredTodos.map(function(todo){return/*#__PURE__*/React.createElement(\"div\",{className:\"mb-3\",key:todo.id},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-prepend\"},/*#__PURE__*/React.createElement(\"span\",{className:\"input-group-text\"},/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\",checked:todo.completed,onChange:function onChange(_ref3){var target=_ref3.target;return dispatch({type:target.checked?'COMPLETE_TODO':'INCOMPLETE_TODO',payload:todo.id});}})),/*#__PURE__*/React.createElement(\"input\",{className:\"form-control\",name:\"todo-\".concat(todo.id),value:todo.name,onChange:function onChange(){}// submit\n,onFocus:function onFocus(){return setFocus(true);},onBlur:function onBlur(){return setTimeout(function(){return setFocus(false);},500);}}),focus?/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-sm ml-1 btn btn-success\",type:\"submit\",onClick:function onClick(){return handleTodoSubmit(todo);}},\"Submit\"):null,focus?/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-sm ml-1 btn btn-danger\",type:\"submit\",onClick:function onClick(){return handleTodoDelete(todo);}},\"Delete\"):null));}),/*#__PURE__*/React.createElement(\"div\",{className:\"btn-filter\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"mr-1 btn btn-primary\",onClick:handleShowAll},\"Show All\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"mr-1 btn btn-primary\",onClick:handleShowCompleted},\"Show Complete\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"mr-1 btn btn-primary\",onClick:handleShowIncompleted},\"Show Incomplete\")))));};export default Todos;","map":{"version":3,"sources":["/Users/dinker/Projects/React/simpleApp/src/components/todo/Todos.jsx"],"names":["React","useEffect","useReducer","useState","axios","todoReducer","URL","FILTER","filterReducer","filterTodos","Todos","initialState","isLoading","isError","todos","newTodoLabel","state","dispatch","filter","dispatchFilter","focus","setFocus","fetchData","type","get","TODOS","then","res","data","result","payload","catch","error","Error","filteredTodos","handleShowAll","SHOW_ALL","handleShowCompleted","SHOW_COMPLETED","handleShowIncompleted","SHOW_INCOMPLETED","handleTodoSubmit","event","preventDefault","post","name","completed","editing","handleTodoDelete","todo","delete","id","length","target","value","e","map","checked","setTimeout"],"mappings":"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","sourcesContent":["import React, { useEffect, useReducer, useState } from 'react';\nimport axios from 'axios';\nimport '../../assets/css/App.css';\nimport todoReducer from '../../reducer/todo.reducer';\nimport { URL, FILTER } from '../../app.constant';\nimport filterReducer from '../../reducer/filter.reducer';\nimport filterTodos from './todo.filter';\n\nconst Todos = () => {\n  const initialState = {\n    isLoading: true,\n    isError: false,\n    todos: [],\n    newTodoLabel: 'Learn smthing new?'\n  };\n\n  const [state, dispatch] = useReducer(todoReducer, initialState);\n  const [filter, dispatchFilter] = useReducer(filterReducer, 'ALL');\n  const { todos, newTodoLabel, isLoading, isError } = state;\n  const [focus, setFocus] = useState(false);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      dispatch({ type: 'FETCH_INIT' });\n      await axios\n        .get(URL.TODOS)\n        .then((res) => res.data)\n        .then((result) =>\n          dispatch({\n            type: 'FETCH_SUCCESS',\n            payload: result\n          })\n        )\n        .catch((error) => {\n          dispatch({ type: 'FETCH_FAILURE' });\n          Error(`Something went wrong... See ${error}`);\n        });\n    };\n    fetchData();\n  }, []); // second empty array parameter to encure that useEffect is running once\n\n  const filteredTodos = filterTodos(todos, filter);\n\n  const handleShowAll = () => dispatchFilter({ type: FILTER.SHOW_ALL });\n  const handleShowCompleted = () => dispatchFilter({ type: FILTER.SHOW_COMPLETED });\n  const handleShowIncompleted = () => dispatchFilter({ type: FILTER.SHOW_INCOMPLETED });\n  // we could've used 1 function to make this work\n  // const handleFilterDisplay = (filter) => dispatchFilter({type: filter})\n\n  const handleTodoSubmit = (event) => {\n    // manque la gestion derreur\n    event.preventDefault();\n    axios\n      .post(URL.TODOS, {\n        name: newTodoLabel,\n        completed: false,\n        editing: false\n      })\n      .then((res) => {\n        dispatch({\n          type: 'ADD_TODO',\n          payload: res.data.name\n        });\n      });\n  };\n\n  const handleTodoDelete = (todo) => {\n    // manque la gestion derreur\n    // const newTodo = filteredTodos.some((el) => el.id === todo.id);\n    axios.delete(`${URL.TODOS}/${todo.id}`).then(() =>\n      dispatch({\n        type: 'REMOVE_TODO',\n        payload: todo.id\n      })\n    );\n  };\n\n  return (\n    <div className=\"App-todos\">\n      {isError ? (\n        <h1>Something went wrong...</h1>\n      ) : (\n        (isLoading && <h1>Loading ...</h1>) || (\n          <>\n            <div className=\"App-todo-heading\">\n              <h1 className=\"mt-4\">You have {filteredTodos.length} to do today</h1>\n            </div>\n            <div className=\"App-new-todo\">\n              <form className=\"form-inline\" onSubmit={handleTodoSubmit}>\n                <input\n                  className=\"form-control\"\n                  type=\"text\"\n                  name=\"todo\"\n                  value={newTodoLabel}\n                  onChange={({ target }) =>\n                    dispatch({\n                      type: 'UPDATE_TODO_LABEL',\n                      payload: target.value\n                    })\n                  }\n                />\n                <button className=\"ml-2 btn btn-primary\" type=\"submit\" onClick={(e) => handleTodoSubmit(e)}>\n                  Add\n                </button>\n              </form>\n            </div>\n            <div className=\"App-todo-item\">\n              {filteredTodos.map((todo) => {\n                return (\n                  <div className=\"mb-3\" key={todo.id}>\n                    <div className=\"input-group-prepend\">\n                      <span className=\"input-group-text\">\n                        <input\n                          type=\"checkbox\"\n                          checked={todo.completed}\n                          onChange={({ target }) =>\n                            dispatch({\n                              type: target.checked ? 'COMPLETE_TODO' : 'INCOMPLETE_TODO',\n                              payload: todo.id\n                            })\n                          }\n                        />\n                      </span>\n                      <input\n                        className=\"form-control\"\n                        name={`todo-${todo.id}`}\n                        value={todo.name}\n                        onChange={() => {}} // submit\n                        onFocus={() => setFocus(true)}\n                        onBlur={() => setTimeout(() => setFocus(false), 500)}\n                      />\n                      {focus ? (\n                        <button\n                          className=\"btn btn-sm ml-1 btn btn-success\"\n                          type=\"submit\"\n                          onClick={() => handleTodoSubmit(todo)}\n                        >\n                          Submit\n                        </button>\n                      ) : null}\n                      {focus ? (\n                        <button\n                          className=\"btn btn-sm ml-1 btn btn-danger\"\n                          type=\"submit\"\n                          onClick={() => handleTodoDelete(todo)}\n                        >\n                          Delete\n                        </button>\n                      ) : null}\n                    </div>\n                  </div>\n                );\n              })}\n              <div className=\"btn-filter\">\n                <button type=\"button\" className=\"mr-1 btn btn-primary\" onClick={handleShowAll}>\n                  Show All\n                </button>\n                <button type=\"button\" className=\"mr-1 btn btn-primary\" onClick={handleShowCompleted}>\n                  Show Complete\n                </button>\n                <button type=\"button\" className=\"mr-1 btn btn-primary\" onClick={handleShowIncompleted}>\n                  Show Incomplete\n                </button>\n              </div>\n            </div>\n          </>\n        )\n      )}\n    </div>\n  );\n};\n\nexport default Todos;\n"]},"metadata":{},"sourceType":"module"}